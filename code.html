<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Frontier Labs • Code Pong</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Futuristic Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --orange: #ff6a00;
      --yellow: #ffb347;
      --orange-grad: linear-gradient(90deg, #ffb347 0%, #ff6a00 80%, #ff9033 100%);
      --black: #181818;
      --grey: #ececec;
      --dark-grey: #232323;
      --nav-glass: rgba(24,28,38,0.91);
      --panel-glass: rgba(38,40,44,0.89);
      --hero-glass: rgba(30,32,36,0.90);
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: 'Montserrat', 'Segoe UI', 'Roboto', Arial, sans-serif;
      background: linear-gradient(135deg, #1a1a1f 0%, #282a33 55%, #1d1e22 100%);
      background-repeat: no-repeat;
      background-attachment: fixed;
      background-size: cover;
      color: var(--grey);
      min-height: 100vh;
      box-sizing: border-box;
    }
    header {
      background: var(--nav-glass);
      backdrop-filter: blur(12px);
      padding: 1.3rem 0 1.1rem 0;
      box-shadow: 0 6px 32px 0 #161920bb, 0 2px 14px 0 #ff6a0018;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      border-bottom: 1.5px solid #22292f;
    }
    .logo {
      background: var(--orange-grad);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-fill-color: transparent;
      font-size: 2.7rem;
      font-weight: 900;
      letter-spacing: 2.8px;
      text-transform: uppercase;
      font-family: 'Orbitron', 'Montserrat', Arial, sans-serif;
      margin-bottom: 0.22rem;
      filter: drop-shadow(0 0 6px #ffb34745);
    }
    nav {
      margin-top: 0.3rem;
      display: flex;
      gap: 1.12rem;
    }
    nav a {
      color: #e3e3e3;
      font-family: 'Orbitron', 'Montserrat', Arial, sans-serif;
      text-decoration: none;
      font-size: 1.07rem;
      letter-spacing: 1.2px;
      padding: 0.36rem 1.15rem;
      border-radius: 20px;
      border: none;
      background: none;
      position: relative;
      transition: color 0.2s, background 0.2s, box-shadow 0.18s;
      z-index: 1;
      overflow: hidden;
      font-weight: 600;
    }
    nav a:hover:not(.resume-btn) {
      color: var(--orange);
      background: #232323;
      box-shadow: 0 0 10px #ff6a0044;
    }
    .resume-btn {
      color: #232323;
      font-weight: 900;
      padding: 0.36rem 1.6rem;
      border-radius: 28px;
      background: var(--orange-grad);
      box-shadow: 0 0 14px 3px var(--orange), 0 0 22px 1px #ffb34788;
      text-shadow: 0 0 2px #ffb34799;
      letter-spacing: 1.5px;
      font-size: 1.12rem;
      margin-left: 0.24rem;
      transition: box-shadow 0.22s, background 0.21s, color 0.18s;
      outline: 1.5px solid #ffb34744;
      cursor: pointer;
      border: none;
      position: relative;
      overflow: hidden;
    }
    .resume-btn:hover, .resume-btn:focus {
      color: #fff;
      background: linear-gradient(90deg, #ff6a00 0%, #ffb347 100%);
      box-shadow: 0 0 32px 9px #ff903355;
      outline: 2px solid #ffb34799;
    }
    .hero {
      background: linear-gradient(120deg, #232532 38%, #ff6a0027 62%, #232323 100%);
      border-radius: 0 0 28px 28px;
      box-shadow: 0 6px 40px 0 #1d1e22cc, 0 1.2px 6px #ff6a0012;
      margin: 0 auto;
      margin-bottom: 2.5rem;
      max-width: 970px;
      padding: 3.5rem 1.2rem 2.8rem 1.2rem;
      text-align: center;
      position: relative;
      overflow: hidden;
      z-index: 1;
    }
    .hero h1 {
      background: var(--orange-grad);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-fill-color: transparent;
      font-size: 3.1rem;
      font-weight: 900;
      letter-spacing: 2.4px;
      margin-bottom: 0.7rem;
      margin-top: 0;
      text-shadow: 0 0 24px #ffb34755;
      filter: drop-shadow(0 0 15px #ffb34722);
      font-family: 'Orbitron', 'Montserrat', Arial, sans-serif;
    }
    .hero p {
      color: #f7f7f7;
      font-size: 1.21rem;
      max-width: 660px;
      margin: 0 auto 1.2rem auto;
      letter-spacing: 1.05px;
      text-shadow: 0 0 12px #1b1b2ba0;
      font-family: 'Montserrat', Arial, sans-serif;
      font-weight: 400;
    }
    .pong-container {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 2.2rem auto 2rem auto;
      background: var(--panel-glass);
      border-radius: 18px;
      box-shadow: 0 4px 24px 0 #181818cc, 0 2px 16px 0 #ff6a0035;
      padding: 2.5rem 2rem;
      border: 1.2px solid #232323;
      max-width: 730px;
      min-height: 480px;
      flex-direction: column;
    }
    .pong-title {
      color: var(--orange);
      font-size: 2rem;
      font-family: 'Orbitron', 'Montserrat', Arial, sans-serif;
      letter-spacing: 1.1px;
      margin-bottom: 1.1rem;
      text-shadow: 0 0 8px #ffb34755;
    }
    .pong-controls {
      font-family: 'Montserrat', Arial, sans-serif;
      font-size: 1.1rem;
      margin-bottom: 0.7rem;
      color: var(--grey);
      letter-spacing: 0.8px;
      text-align: center;
    }
    canvas#pong {
      background: #18181f;
      border-radius: 12px;
      box-shadow: 0 0 32px 2px #ffb34722, 0 2px 8px #232323aa;
      border: 1.5px solid #232323;
      margin-top: 1rem;
      margin-bottom: 0.8rem;
      display: block;
      max-width: 100%;
    }
    .pong-score {
      color: var(--yellow);
      font-size: 1.35rem;
      font-family: 'Orbitron', 'Montserrat', Arial, sans-serif;
      margin: 1rem auto 0 auto;
      letter-spacing: 1.4px;
      text-align: center;
      text-shadow: 0 0 12px #ffb34744;
    }
    .arcade-container {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      margin: 2.2rem auto 3rem auto;
      background: var(--panel-glass);
      border-radius: 18px;
      box-shadow: 0 4px 24px 0 #181818cc, 0 2px 16px 0 #ff6a0035;
      padding: 2.6rem 2rem;
      border: 1.2px solid #232323;
      max-width: 820px;
    }
    .arcade-title {
      color: var(--orange);
      font-size: 2rem;
      font-family: 'Orbitron', 'Montserrat', Arial, sans-serif;
      letter-spacing: 1.1px;
      margin-bottom: 0.9rem;
      text-shadow: 0 0 8px #ffb34755;
      text-align: center;
    }
    .arcade-controls {
      font-family: 'Montserrat', Arial, sans-serif;
      font-size: 1rem;
      margin-bottom: 1rem;
      color: var(--grey);
      letter-spacing: 0.8px;
      text-align: center;
      max-width: 560px;
    }
    canvas#asteroids {
      background: #0f1016;
      border-radius: 16px;
      box-shadow: 0 0 36px 3px #ffb3471c, 0 2px 8px #232323aa;
      border: 1.5px solid #232323;
      display: block;
      max-width: 100%;
    }
    .asteroids-hud {
      margin-top: 1.2rem;
      display: flex;
      gap: 1.4rem;
      flex-wrap: wrap;
      justify-content: center;
      font-family: 'Orbitron', 'Montserrat', Arial, sans-serif;
      font-size: 1rem;
      color: #ffdfba;
      letter-spacing: 0.8px;
    }
    .asteroids-hud span {
      background: rgba(15,16,24,0.65);
      padding: 0.4rem 0.9rem;
      border-radius: 12px;
      border: 1px solid #2c2f37;
      box-shadow: inset 0 0 8px #050506;
    }
    @media (max-width: 900px) {
      .pong-container { padding: 1.3rem 0.6rem; min-height: 360px;}
      .arcade-container { padding: 1.4rem 0.8rem; }
    }
    @media (max-width: 700px) {
      nav { flex-direction: column; gap: 0.5rem; }
      .logo { font-size: 1.45rem; }
      .pong-title { font-size: 1.25rem; }
      .pong-score { font-size: 1.1rem; }
      .pong-container { padding: 0.7rem 0.1rem; }
      .arcade-title { font-size: 1.35rem; }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">Frontier Labs</div>
    <nav>
      <a href="index.html">Home</a>
      <a href="services.html">Services</a>
      <a href="projects.html">Projects</a>
      <a href="code.html">Code</a>
      <a href="shop.html" data-product-link>Product</a>
      <a href="ai.html" data-product-link>AI</a>
      <a href="#">Contact</a>
      <a href="resume.html" class="resume-btn">Resume</a>
    </nav>
  </header>

  <div class="hero">
    <h1>Pong Game</h1>
    <p>
      Classic Pong — but with a robotic right paddle.<br>
      <b>W</b>/<b>S</b> for Left Paddle. Right paddle: AI.<br>
      <span style="color:#ffb347;font-weight:700;">First to 7 wins!</span>
    </p>
  </div>

  <div class="pong-container">
    <div class="pong-title">Play Pong</div>
    <div class="pong-controls">
      <b>Left Paddle:</b> W / S &nbsp; | &nbsp;
      <b>Right Paddle:</b> Easy AI<br>
      <span style="font-size:0.95rem; color:#ffb347">Try to score if you can!</span>
    </div>
    <canvas id="pong" width="600" height="400"></canvas>
    <div class="pong-score" id="pong-score"></div>
  </div>

  <div class="arcade-container">
    <div class="arcade-title">Asteroid Defense</div>
    <div class="arcade-controls">
      Pilot the glowing Frontier Labs ship through an asteroid field.<br>
      <b>Arrow Keys:</b> rotate + thrust &nbsp; | &nbsp; <b>Space:</b> pulse cannon &nbsp; | &nbsp; <b>R:</b> restart after destruction
    </div>
    <canvas id="asteroids" width="640" height="420"></canvas>
    <div class="asteroids-hud">
      <span id="asteroids-score">Score: 0</span>
      <span id="asteroids-lives">Shields: 3</span>
      <span id="asteroids-wave">Wave: 1</span>
    </div>
  </div>

  <footer>
    &copy; 2025 Frontier Labs. All rights reserved.
  </footer>

  <script src="product-guard.js"></script>
  <script>
    // --- Pong Game Logic ---

    const canvas = document.getElementById('pong');
    const ctx = canvas.getContext('2d');

    // Colors from site style
    const COLOR_BG = "#18181f";
    const COLOR_NET = "#ffb34744";
    const COLOR_PADDLE = "#ffb347";
    const COLOR_PADDLE_SHADOW = "#ff6a0033";
    const COLOR_BALL = "#ff6a00";
    const COLOR_SCORE = "#ffb347";
    const COLOR_TEXT = "#ececec";

    // Game vars
    const PADDLE_WIDTH = 12;
    const PADDLE_HEIGHT = 74;
    const AI_PADDLE_HEIGHT = PADDLE_HEIGHT / 2;
    const PADDLE_SPEED = 6;
    const AI_SPEED = 14; // AI paddle jumps directly to ball, can be > PADDLE_SPEED
    const BALL_SIZE = 18;
    const BALL_SPEED = 3.3; // 50% slower than classic pong
    let leftScore = 0, rightScore = 0, maxScore = 7;

    let paddleLeft = { x: 18, y: (canvas.height-PADDLE_HEIGHT)/2, vy: 0 };
    let paddleRight = { x: canvas.width-18-PADDLE_WIDTH, y: (canvas.height-AI_PADDLE_HEIGHT)/2, vy: 0 };

    let ball = {
      x: (canvas.width-BALL_SIZE)/2,
      y: (canvas.height-BALL_SIZE)/2,
      vx: Math.random() > 0.5 ? BALL_SPEED : -BALL_SPEED,
      vy: (Math.random()*2-1) * BALL_SPEED
    };

    let keys = {};

    function resetBall(direction = 1) {
      ball.x = (canvas.width-BALL_SIZE)/2;
      ball.y = (canvas.height-BALL_SIZE)/2;
      // Randomize y velocity, keep speed
      let angle = (Math.random()-0.5)*Math.PI/2;
      let speed = BALL_SPEED;
      ball.vx = speed * direction;
      ball.vy = speed * Math.sin(angle);
    }

    function draw() {
      // Background
      ctx.fillStyle = COLOR_BG;
      ctx.fillRect(0,0,canvas.width,canvas.height);

      // Net
      for(let y=8; y<canvas.height; y+=32) {
        ctx.fillStyle = COLOR_NET;
        ctx.fillRect(canvas.width/2-2, y, 4, 18);
      }

      // Left Paddle (Player)
      ctx.save();
      ctx.shadowColor = COLOR_PADDLE_SHADOW;
      ctx.shadowBlur = 10;
      ctx.fillStyle = COLOR_PADDLE;
      ctx.fillRect(paddleLeft.x, paddleLeft.y, PADDLE_WIDTH, PADDLE_HEIGHT);
      ctx.restore();

      // Right Paddle (AI)
      ctx.save();
      ctx.shadowColor = COLOR_PADDLE_SHADOW;
      ctx.shadowBlur = 10;
      ctx.fillStyle = COLOR_PADDLE;
      ctx.fillRect(paddleRight.x, paddleRight.y, PADDLE_WIDTH, AI_PADDLE_HEIGHT);
      ctx.restore();

      // Ball
      ctx.save();
      ctx.shadowColor = COLOR_BALL;
      ctx.shadowBlur = 12;
      ctx.fillStyle = COLOR_BALL;
      ctx.fillRect(ball.x, ball.y, BALL_SIZE, BALL_SIZE);
      ctx.restore();

      // Score
      ctx.fillStyle = COLOR_SCORE;
      ctx.font = "bold 2.3rem Orbitron, Montserrat, Arial";
      ctx.textAlign = "center";
      ctx.fillText(leftScore, canvas.width/2-56, 54);
      ctx.fillText(rightScore, canvas.width/2+56, 54);

      // Win Message
      if (leftScore >= maxScore || rightScore >= maxScore) {
        ctx.fillStyle = COLOR_TEXT;
        ctx.font = "bold 1.8rem Montserrat, Arial";
        ctx.textAlign = "center";
        ctx.fillText(
          leftScore >= maxScore ? "Player Wins!" : "AI Wins!",
          canvas.width/2, canvas.height/2-18
        );
        ctx.font = "1.2rem Montserrat, Arial";
        ctx.fillText("Press Space to Restart", canvas.width/2, canvas.height/2+24);
      }
    }

    function update() {
      // Paddle movement (W/S for player)
      if (keys['w']) paddleLeft.y -= PADDLE_SPEED;
      if (keys['s']) paddleLeft.y += PADDLE_SPEED;
      // Stay in bounds
      paddleLeft.y = Math.max(0, Math.min(canvas.height-PADDLE_HEIGHT, paddleLeft.y));

      // AI paddle follows ball directly and is always on time
      if (leftScore < maxScore && rightScore < maxScore) {
        let aiTarget = ball.y + BALL_SIZE/2 - AI_PADDLE_HEIGHT/2;
        // "Snap" AI paddle directly for unbeatable, but clamp to bounds
        paddleRight.y = Math.max(0, Math.min(canvas.height-AI_PADDLE_HEIGHT, aiTarget));
      }

      // Ball movement (if not game over)
      if (leftScore < maxScore && rightScore < maxScore) {
        ball.x += ball.vx;
        ball.y += ball.vy;

        // Top/bottom wall
        if (ball.y < 0 || ball.y > canvas.height-BALL_SIZE) {
          ball.vy *= -1;
          ball.y = Math.max(0, Math.min(canvas.height-BALL_SIZE, ball.y));
        }

        // Paddle collision (left/player)
        if (ball.x <= paddleLeft.x+PADDLE_WIDTH &&
            ball.y+BALL_SIZE > paddleLeft.y &&
            ball.y < paddleLeft.y+PADDLE_HEIGHT) {
          ball.x = paddleLeft.x+PADDLE_WIDTH;
          ball.vx *= -1.08; // Speed up a bit
          // Add "spin"
          ball.vy += (ball.y+BALL_SIZE/2-(paddleLeft.y+PADDLE_HEIGHT/2))/14;
        }

        // Paddle collision (right/AI)
        if (ball.x+BALL_SIZE >= paddleRight.x &&
            ball.y+BALL_SIZE > paddleRight.y &&
            ball.y < paddleRight.y+AI_PADDLE_HEIGHT) {
          ball.x = paddleRight.x-BALL_SIZE;
          ball.vx *= -1.08;
          ball.vy += (ball.y+BALL_SIZE/2-(paddleRight.y+AI_PADDLE_HEIGHT/2))/14;
        }

        // Score (left misses)
        if (ball.x < -BALL_SIZE) {
          rightScore += 1;
          resetBall(-1);
        }
        // Score (right/AI misses)
        if (ball.x > canvas.width) {
          leftScore += 1;
          resetBall(1);
        }
      }
    }

    function loop() {
      update();
      draw();
      // Show score below canvas (for mobile users)
      document.getElementById('pong-score').textContent = `${leftScore} : ${rightScore}`;
      requestAnimationFrame(loop);
    }

    // Controls
    window.addEventListener('keydown', function(e) {
      // Prevent arrow key page scroll if playing
      if(['ArrowUp','ArrowDown',' '].includes(e.key)) e.preventDefault();
      keys[e.key.toLowerCase()] = true;
      // Restart on space
      if (e.key === " " && (leftScore >= maxScore || rightScore >= maxScore)) {
        leftScore = 0;
        rightScore = 0;
        resetBall(Math.random() > 0.5 ? 1 : -1);
      }
    }, {passive:false});
    window.addEventListener('keyup', function(e) {
      keys[e.key.toLowerCase()] = false;
    });

    // Start Game
    resetBall(Math.random() > 0.5 ? 1 : -1);
    loop();

    // --- Asteroid Defense Logic ---

    const astCanvas = document.getElementById('asteroids');
    if (astCanvas) {
      const astCtx = astCanvas.getContext('2d');
      const scoreEl = document.getElementById('asteroids-score');
      const livesEl = document.getElementById('asteroids-lives');
      const waveEl = document.getElementById('asteroids-wave');

      const stars = Array.from({ length: 42 }, () => ({
        x: Math.random() * astCanvas.width,
        y: Math.random() * astCanvas.height,
        r: Math.random() * 1.7 + 0.4
      }));

      const ship = {
        x: astCanvas.width / 2,
        y: astCanvas.height / 2,
        angle: -Math.PI / 2,
        vx: 0,
        vy: 0,
        radius: 16,
        invincible: 2
      };

      let asteroidScore = 0;
      let asteroidLives = 3;
      let asteroidWave = 1;
      let asteroidGameOver = false;
      let asteroids = [];
      let bullets = [];
      let lastShotTime = 0;
      let lastAsteroidsTime = performance.now();

      const SHIP_THRUST = 240;
      const SHIP_TURN_SPEED = 3.8;
      const SHIP_DRAG = 0.992;
      const BULLET_SPEED = 420;
      const BULLET_LIFETIME = 1.2;
      const SHOT_COOLDOWN = 240; // milliseconds
      const BASE_ASTEROID_SPEED = 38;

      function updateAstroHud() {
        scoreEl.textContent = `Score: ${asteroidScore}`;
        livesEl.textContent = `Shields: ${asteroidLives}`;
        waveEl.textContent = `Wave: ${asteroidWave}`;
      }

      function wrapEntity(entity, radius) {
        if (entity.x < -radius) entity.x = astCanvas.width + radius;
        if (entity.x > astCanvas.width + radius) entity.x = -radius;
        if (entity.y < -radius) entity.y = astCanvas.height + radius;
        if (entity.y > astCanvas.height + radius) entity.y = -radius;
      }

      function distance(x1, y1, x2, y2) {
        return Math.hypot(x1 - x2, y1 - y2);
      }

      function createAsteroid(size = 3, originX, originY) {
        const speed = BASE_ASTEROID_SPEED + Math.random() * (40 + asteroidWave * 10);
        const angle = Math.random() * Math.PI * 2;
        const radius = size === 3 ? 42 : size === 2 ? 28 : 18;
        let x = originX;
        let y = originY;
        if (typeof originX !== 'number' || typeof originY !== 'number') {
          do {
            x = Math.random() * astCanvas.width;
            y = Math.random() * astCanvas.height;
          } while (distance(x, y, ship.x, ship.y) < 120);
        }
        return {
          x,
          y,
          vx: Math.cos(angle) * speed,
          vy: Math.sin(angle) * speed,
          radius,
          size
        };
      }

      function spawnWave() {
        const count = Math.min(3 + asteroidWave, 11);
        for (let i = 0; i < count; i++) {
          asteroids.push(createAsteroid(3));
        }
      }

      function resetAsteroidsGame() {
        asteroidScore = 0;
        asteroidLives = 3;
        asteroidWave = 1;
        asteroidGameOver = false;
        asteroids = [];
        bullets = [];
        resetShipPosition();
        spawnWave();
        updateAstroHud();
      }

      function resetShipPosition() {
        ship.x = astCanvas.width / 2;
        ship.y = astCanvas.height / 2;
        ship.vx = 0;
        ship.vy = 0;
        ship.angle = -Math.PI / 2;
        ship.invincible = 2;
      }

      function fireBullet() {
        if (asteroidGameOver) return;
        const now = performance.now();
        if (now - lastShotTime < SHOT_COOLDOWN) return;
        lastShotTime = now;
        bullets.push({
          x: ship.x + Math.cos(ship.angle) * ship.radius,
          y: ship.y + Math.sin(ship.angle) * ship.radius,
          angle: ship.angle,
          life: BULLET_LIFETIME
        });
      }

      function destroyAsteroid(index) {
        const [target] = asteroids.splice(index, 1);
        if (!target) return;
        asteroidScore += target.size === 3 ? 60 : target.size === 2 ? 90 : 130;
        if (target.size > 1) {
          for (let i = 0; i < 2; i++) {
            const fragment = createAsteroid(target.size - 1, target.x, target.y);
            asteroids.push(fragment);
          }
        }
        if (!asteroids.length) {
          asteroidWave += 1;
          spawnWave();
        }
        updateAstroHud();
      }

      function updateAsteroids(delta) {
        if (asteroidGameOver) return;

        if (keys['arrowleft']) {
          ship.angle -= SHIP_TURN_SPEED * delta;
        }
        if (keys['arrowright']) {
          ship.angle += SHIP_TURN_SPEED * delta;
        }
        if (keys['arrowup']) {
          ship.vx += Math.cos(ship.angle) * SHIP_THRUST * delta;
          ship.vy += Math.sin(ship.angle) * SHIP_THRUST * delta;
        }

        ship.vx *= SHIP_DRAG;
        ship.vy *= SHIP_DRAG;
        ship.x += ship.vx * delta;
        ship.y += ship.vy * delta;
        wrapEntity(ship, ship.radius);

        bullets = bullets.filter((bullet) => bullet.life > 0);
        bullets.forEach((bullet) => {
          bullet.x += Math.cos(bullet.angle) * BULLET_SPEED * delta;
          bullet.y += Math.sin(bullet.angle) * BULLET_SPEED * delta;
          bullet.life -= delta;
          wrapEntity(bullet, 4);
        });

        asteroids.forEach((ast) => {
          ast.x += ast.vx * delta;
          ast.y += ast.vy * delta;
          wrapEntity(ast, ast.radius);
        });

        // Bullet collisions
        for (let i = bullets.length - 1; i >= 0; i--) {
          for (let j = asteroids.length - 1; j >= 0; j--) {
            if (distance(bullets[i].x, bullets[i].y, asteroids[j].x, asteroids[j].y) < asteroids[j].radius) {
              bullets.splice(i, 1);
              destroyAsteroid(j);
              break;
            }
          }
        }

        if (ship.invincible > 0) {
          ship.invincible = Math.max(0, ship.invincible - delta);
        } else {
          for (let i = 0; i < asteroids.length; i++) {
            if (distance(ship.x, ship.y, asteroids[i].x, asteroids[i].y) < ship.radius + asteroids[i].radius) {
              asteroidLives -= 1;
              updateAstroHud();
              if (asteroidLives <= 0) {
                asteroidGameOver = true;
              } else {
                resetShipPosition();
              }
              break;
            }
          }
        }
      }

      function drawShip() {
        astCtx.save();
        if (ship.invincible > 0 && Math.floor(ship.invincible * 10) % 2 === 0) {
          astCtx.globalAlpha = 0.35;
        }
        astCtx.translate(ship.x, ship.y);
        astCtx.rotate(ship.angle);
        astCtx.beginPath();
        astCtx.moveTo(ship.radius, 0);
        astCtx.lineTo(-ship.radius * 0.7, ship.radius * 0.75);
        astCtx.lineTo(-ship.radius * 0.5, 0);
        astCtx.lineTo(-ship.radius * 0.7, -ship.radius * 0.75);
        astCtx.closePath();
        astCtx.fillStyle = '#ff6a00';
        astCtx.shadowColor = '#ffb347';
        astCtx.shadowBlur = 12;
        astCtx.fill();
        astCtx.restore();
      }

      function drawAsteroids() {
        astCtx.fillStyle = '#0f1016';
        astCtx.fillRect(0, 0, astCanvas.width, astCanvas.height);

        stars.forEach((star) => {
          astCtx.fillStyle = '#ffffff';
          astCtx.globalAlpha = 0.5 + Math.random() * 0.5;
          astCtx.beginPath();
          astCtx.arc(star.x, star.y, star.r, 0, Math.PI * 2);
          astCtx.fill();
        });
        astCtx.globalAlpha = 1;

        asteroids.forEach((ast) => {
          astCtx.save();
          astCtx.translate(ast.x, ast.y);
          astCtx.rotate((ast.x + ast.y) * 0.001);
          astCtx.strokeStyle = '#ffb347';
          astCtx.lineWidth = 2;
          astCtx.beginPath();
          const points = 10;
          for (let i = 0; i < points; i++) {
            const angle = (Math.PI * 2 * i) / points;
            const radius = ast.radius * (0.7 + Math.random() * 0.4);
            const px = Math.cos(angle) * radius;
            const py = Math.sin(angle) * radius;
            if (i === 0) astCtx.moveTo(px, py);
            else astCtx.lineTo(px, py);
          }
          astCtx.closePath();
          astCtx.stroke();
          astCtx.restore();
        });

        bullets.forEach((bullet) => {
          astCtx.save();
          astCtx.fillStyle = '#ffdfba';
          astCtx.shadowColor = '#ffb347';
          astCtx.shadowBlur = 8;
          astCtx.beginPath();
          astCtx.arc(bullet.x, bullet.y, 3, 0, Math.PI * 2);
          astCtx.fill();
          astCtx.restore();
        });

        drawShip();

        if (asteroidGameOver) {
          astCtx.fillStyle = 'rgba(0,0,0,0.55)';
          astCtx.fillRect(0, 0, astCanvas.width, astCanvas.height);
          astCtx.fillStyle = '#ffdfba';
          astCtx.font = "bold 1.7rem Orbitron, Montserrat, Arial";
          astCtx.textAlign = 'center';
          astCtx.fillText('Mission Lost', astCanvas.width / 2, astCanvas.height / 2 - 10);
          astCtx.font = "1rem Montserrat, Arial";
          astCtx.fillText('Press R to relaunch the Frontier Labs ship.', astCanvas.width / 2, astCanvas.height / 2 + 18);
        }
      }

      function asteroidsLoop(now) {
        const delta = Math.min(0.05, (now - lastAsteroidsTime) / 1000);
        lastAsteroidsTime = now;
        updateAsteroids(delta);
        drawAsteroids();
        requestAnimationFrame(asteroidsLoop);
      }

      window.addEventListener('keydown', (event) => {
        if (event.code === 'Space') {
          fireBullet();
        }
        if (asteroidGameOver && event.key.toLowerCase() === 'r') {
          resetAsteroidsGame();
        }
      });

      updateAstroHud();
      spawnWave();
      requestAnimationFrame(asteroidsLoop);
    }

  </script>
</body>
</html>
